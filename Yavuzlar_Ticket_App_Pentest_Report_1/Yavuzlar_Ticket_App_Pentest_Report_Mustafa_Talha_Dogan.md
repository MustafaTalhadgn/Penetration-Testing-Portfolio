![](images/_page_0_Picture_0.jpeg)

# **YAVUZLAR BÄ°LET SATIN ALMA UYGULAMASI PENTEST RAPORU**

**Ä°sim: Mustafa Talha DOÄAN**

**TakÄ±m: Yavuzlar 16**

**Ä°ncelediÄŸi Proje:<https://github.com/taro544/bilet-satin-alma>**

# **NOT:**

Pentest sÃ¼recinde uygulama analiz edilirken, uygulamanÄ±n temel SatÄ±n Al iÅŸlevinin kritik bir veritabanÄ± hatasÄ± nedeniyle Ã§alÄ±ÅŸmadÄ±ÄŸÄ± tespit edilmiÅŸtir.

**Tespit Edilen Hata:** SatÄ±n alma sÄ±rasÄ±nda hata oluÅŸtu: SQLSTATE[HY000]: General error: 1 table tickets has no column named company\_name

HatanÄ±n KÃ¶k Nedeni: Analiz sonucunda, cart.php dosyasÄ±ndaki checkout kod bloÄŸunun tickets tablosuna yeni bir kayÄ±t eklerken, veritabanÄ± ÅŸemasÄ±nda bulunmayan birden fazla sÃ¼tuna veri yazmaya Ã§alÄ±ÅŸtÄ±ÄŸÄ± gÃ¶rÃ¼lmÃ¼ÅŸtÃ¼r. Bu sÃ¼tunlar: company\_name, departure\_city, arrival\_city, departure\_time ve arrival\_time'dÄ±r. Bu durum, uygulama kodu ile veritabanÄ± ÅŸemasÄ± arasÄ±nda bir uyumsuzluk olduÄŸunu gÃ¶stermektedir.

**Testin DevamlÄ±lÄ±ÄŸÄ± Ä°Ã§in Uygulanan Eylem:** Raporun ilerleyen bÃ¶lÃ¼mlerinde belgelenen Ã¶deme akÄ±ÅŸÄ± zafiyetlerini ortaya Ã§Ä±karabilmek ve uygulamanÄ±n tam bir gÃ¼venlik analizini tamamlayabilmek amacÄ±yla, hedef sistemin veritabanÄ± ÅŸemasÄ±na tarafÄ±mca mÃ¼dahale edilmiÅŸtir. tickets tablosuna aÅŸaÄŸÄ±daki SQL komutlarÄ± uygulanarak eksik sÃ¼tunlar eklenmiÅŸtir:

#### **SQL KomutlarÄ±:**

ALTER TABLE tickets ADD COLUMN company\_name TEXT;

ALTER TABLE tickets ADD COLUMN departure\_city TEXT;

ALTER TABLE tickets ADD COLUMN arrival\_city TEXT;

ALTER TABLE tickets ADD COLUMN departure\_time DATETIME;

ALTER TABLE tickets ADD COLUMN arrival\_time DATETIME;

#### **UYARI:**

Bu belge, Yavuzlar Web GÃ¼venliÄŸi EÄŸitim ProgramÄ± kapsamÄ±nda, tamamen eÄŸitim ve Ã¶ÄŸrenim amacÄ±yla hazÄ±rlanmÄ±ÅŸ bir penetrasyon testi sonuÃ§ raporudur. Ä°Ã§erik, testin yapÄ±ldÄ±ÄŸÄ± anÄ± yansÄ±tmakta olup, hatalar veya eksik deÄŸerlendirmeler iÃ§erebilir.

Bu rapor, Mustafa Talha DOÄAN (Yavuzlar 16) tarafÄ±ndan, [https://github.com/taro544/bilet](https://github.com/taro544/bilet-satin-alma)[satin-alma](https://github.com/taro544/bilet-satin-alma) adresinde kaynak kodlarÄ± bulunan Bilet SatÄ±n Alma Platformu projesine karÅŸÄ±, gÃ¶rev tanÄ±mÄ±nda belirtilen kurallar Ã§erÃ§evesinde yazÄ±lmÄ±ÅŸtÄ±r. Burada yapÄ±lanlarÄ±n herhangi bir yasal yÃ¼kÃ¼mlÃ¼lÃ¼ÄŸÃ¼ bulunmamaktadÄ±r.

# Ä°Ã§indekiler

| YÃ¶netici Ã–zeti                                                | 4  |
|---------------------------------------------------------------|----|
| Raporlama ve Metodoloji                                       | 5  |
| KAPSAM                                                        | 5  |
| TEST METODOLOJISI                                             | 5  |
| RÄ°SK DEÄERLENDÄ°RMESÄ°                                          | 5  |
| ZAFÄ°YET BULGULARI VE DETAYLARI                                | 7  |
| BULGU-01                                                      | 7  |
| AÃ§Ä±k eriÅŸilebilir SQLite veritabanÄ± dosyasÄ±-database.sqlite   | 7  |
| BULGU-02                                                      | 9  |
| Kupon DoÄŸrulama EksikliÄŸinden Kaynaklanan Ä°ÅŸ MantÄ±ÄŸÄ± Zafiyeti | 9  |
| BULGU-03                                                      | 12 |
| Siteler ArasÄ± Ä°stek SahteciliÄŸi (CSRF)                        | 12 |
| BULGU-04                                                      | 16 |
| ZavÄ±f Kimlik DoÄŸrulama                                        | 16 |

# <span id="page-3-0"></span>**YÃ¶netici Ã–zeti**

Bu rapor, Yavuzlar Web GÃ¼venliÄŸi EÄŸitim ProgramÄ± kapsamÄ±nda, github.com/taro544/biletsatin-alma adresinde kaynak kodlarÄ± bulunan Bilet SatÄ±n Alma Platformu projesine yÃ¶nelik 26.10.2025-28.10.2025 tarihleri arasÄ±nda gerÃ§ekleÅŸtirilen beyaz kutu (white-box) penetrasyon testi bulgularÄ±nÄ± Ã¶zetlemektedir.

Testler sonucunda, uygulamanÄ±n gÃ¼venlik olgunluÄŸunun dÃ¼ÅŸÃ¼k seviyede olduÄŸu ve canlÄ± bir sistemde kullanÄ±lmasÄ± durumunda kritik riskler barÄ±ndÄ±rdÄ±ÄŸÄ± tespit edilmiÅŸtir. UygulamanÄ±n, modern web uygulamalarÄ± iÃ§in temel kabul edilen Ã§ok sayÄ±da gÃ¼venlik kontrolÃ¼nden yoksun olduÄŸu gÃ¶rÃ¼lmÃ¼ÅŸtÃ¼r.

Tespit edilen zafiyetler, uygulamanÄ±n veri gizliliÄŸini, bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ ve finansal gÃ¼venilirliÄŸini doÄŸrudan tehdit etmektedir. BaÅŸlÄ±ca kritik bulgular ÅŸunlardÄ±r:

- Kritik Veri SÄ±zÄ±ntÄ±sÄ± (Bulgu-01): UygulamanÄ±n tÃ¼m veritabanÄ± (database.sqlite), internet Ã¼zerinden herhangi bir kimlik doÄŸrulamasÄ± olmaksÄ±zÄ±n doÄŸrudan indirilebilir durumdadÄ±r. Bu durum, tÃ¼m kullanÄ±cÄ±larÄ±n ve yÃ¶neticilerin kiÅŸisel bilgilerinin ve parola karmalarÄ±nÄ±n (hash) Ã§alÄ±nmasÄ±na yol aÃ§maktadÄ±r.
- Finansal KayÄ±p Riski (Bulgu-02): FiyatlandÄ±rma mekanizmasÄ±nda, saldÄ±rganlarÄ±n bir firmaya ait indirim kuponunu baÅŸka bir firma iÃ§in kullanmasÄ±na olanak tanÄ±yan kritik bir iÅŸ mantÄ±ÄŸÄ± hatasÄ± bulunmaktadÄ±r. Bu, doÄŸrudan gelir kaybÄ±na neden olabilir.
- Hesap Ele GeÃ§irme ve Veri ManipÃ¼lasyonu (Bulgu-03 & 04): Uygulama, Siteler ArasÄ± Ä°stek SahteciliÄŸi (CSRF) ve Kaba Kuvvet (Brute Force) saldÄ±rÄ±larÄ±na karÅŸÄ± savunmasÄ±zdÄ±r. Bu zafiyetler birleÅŸtirildiÄŸinde, kÃ¶tÃ¼ niyetli kiÅŸilerin:
  - o KullanÄ±cÄ± ve firma hesaplarÄ±nÄ± ele geÃ§irmesine,
  - o Firma sahiplerinin haberi olmadan seferlerini silmesine, fiyatlarÄ±nÄ± manipÃ¼le etmesine veya sahte seferler eklemesine,
  - o KullanÄ±cÄ±larÄ±n haberi olmadan adlarÄ±na bilet satÄ±n almasÄ±na olanak tanÄ±maktadÄ±r.

UygulamanÄ±n temel iÅŸlevlerini doÄŸrudan etkileyen bu yÃ¼ksek ve kritik seviyeli zafiyetlerin, sistemin gÃ¼venliÄŸini saÄŸlamak amacÄ±yla Ã¶ncelikli olarak giderilmesi ÅŸiddetle tavsiye edilmektedir.

# <span id="page-4-0"></span>**Raporlama ve Metodoloji**

#### <span id="page-4-1"></span>**KAPSAM**

Test, http://localhost:8080 Ã¼zerinde Ã§alÄ±ÅŸan uygulamanÄ±n tamamÄ±nÄ± kapsamaktadÄ±r. DoS/DDoS saldÄ±rÄ±larÄ±, sosyal mÃ¼hendislik ve fiziksel gÃ¼venlik testleri kapsam dÄ±ÅŸÄ±dÄ±r.

# <span id="page-4-2"></span>**TEST METODOLOJÄ°SÄ°**

Bu sÄ±zma testi, https://github.com/taro544/bilet-satin-alma adresindeki uygulamanÄ±n kaynak kodlarÄ±na eriÅŸim saÄŸlanarak gerÃ§ekleÅŸtirilmiÅŸtir.

# <span id="page-4-3"></span>**RÄ°SK DEÄERLENDÄ°RMESÄ°**

## **CVSS Nedir ve NasÄ±l Ã‡alÄ±ÅŸÄ±r**

Bu rapordaki bulgularÄ±n teknik ciddiyetini Ã¶lÃ§mek iÃ§in, endÃ¼stri standardÄ± olan CVSS (Common Vulnerability Scoring System) esas alÄ±nmÄ±ÅŸtÄ±r. CVSS, her bir zafiyetin ÅŸiddetini 0.0 ile 10.0 arasÄ±nda sayÄ±sal bir puanla ifade eden aÃ§Ä±k kaynaklÄ± bir sistemdir. Bu puanlama, bir zafiyetin ne kadar kolay istismar edilebileceÄŸini ve baÅŸarÄ±lÄ± bir saldÄ±rÄ±nÄ±n etkisini objektif bir ÅŸekilde Ã¶lÃ§er.

Bu deÄŸerlendirmede CVSS v3.1 standardÄ± kullanÄ±lmÄ±ÅŸtÄ±r. Hesaplamalar, [Chandanbn CVSS](https://chandanbn.github.io/cvss/)  [Calculator](https://chandanbn.github.io/cvss/) aracÄ± Ã¼zerinden yapÄ±lmÄ±ÅŸtÄ±r. CVSS v3.1, her zafiyeti sekiz temel metrik (Attack Vector, Attack Complexity, Privileges Required, User Interaction, Scope, Confidentiality, Integrity, Availability) Ã¼zerinden deÄŸerlendirir ve bu metriklerin kombinasyonu sonucunda Base Score Ã¼retilir.

Balbix CVSS rehberine gÃ¶re, bu puan yalnÄ±zca bir zafiyetin ÅŸiddet derecesini temsil eder; organizasyonel risk dÃ¼zeyi ise sistemin Ã¶nemi, varlÄ±k deÄŸeri, tehdit ortamÄ± ve mevcut gÃ¼venlik Ã¶nlemleri gibi Ã§evresel faktÃ¶rlere gÃ¶re deÄŸiÅŸebilir. DolayÄ±sÄ±yla CVSS, teknik ciddiyet Ã¶lÃ§Ã¼mÃ¼nde referans olarak alÄ±nmÄ±ÅŸ; ancak nihai risk deÄŸerlendirmesi, sistem baÄŸlamÄ±nda yorumlanmÄ±ÅŸtÄ±r.

#### **Referanslar**

*[https://www.balbix.com/insights/understanding-cvss-](https://www.balbix.com/insights/understanding-cvss-scores/#:~:text=CVSS%20scoring%20assigns%20a%20number,characteristics%20may%20change%20over%20time)*

*[scores/#:~:text=CVSS%20scoring%20assigns%20a%20number,characteristics](https://www.balbix.com/insights/understanding-cvss-scores/#:~:text=CVSS%20scoring%20assigns%20a%20number,characteristics%20may%20change%20over%20time) [%20may%20change%20over%20time.](https://www.balbix.com/insights/understanding-cvss-scores/#:~:text=CVSS%20scoring%20assigns%20a%20number,characteristics%20may%20change%20over%20time)*

<https://chandanbn.github.io/cvss/>

#### **CVSS Puan AralÄ±klarÄ± ve Risk Seviyeleri**

| Seviye               | CVSS Puan AralÄ±ÄŸÄ± | AÃ§Ä±klama ve Proje Ã–zelinde Ã–rnekler                                                                                                                                                                                                                                                                                     |
|----------------------|-------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| KRÄ°TÄ°K<br>(Critical) | 9.0 â€“<br>10.0     | Sunucu YanÄ±yor<br>Uzaktan, herhangi bir ayrÄ±calÄ±k veya kullanÄ±cÄ±<br>etkileÅŸimi<br>gerektirmeden<br>istismar<br>edilebilen<br>zafiyetlerdir.<br>Sistemin<br>tamamÄ±nÄ±n<br>ele<br>geÃ§irilmesine<br>(RCE),<br>veritabanÄ±<br>sÄ±zmasÄ±na veya geri dÃ¶nÃ¼lemez veri kaybÄ±na yol aÃ§abilir.                                        |
| YÃœKSEK<br>(High)     | 7.0 -<br>8.9      | Kilitli KapÄ±larÄ± AÃ§mak<br>Genellikle bir kullanÄ±cÄ±nÄ±n oturumunu ele<br>geÃ§irmeye<br>veya<br>baÅŸka<br>bir<br>kullanÄ±cÄ±nÄ±n/firmanÄ±n<br>verilerini<br>gÃ¶rmeye veya deÄŸiÅŸtirmeye (IDOR) olanak tanÄ±yan zafiyetler.                                                                                                          |
| ORTA                 | 4.0 -<br>6.9      | KapÄ±yÄ± AralÄ±klÄ± BÄ±rakmak<br>SaldÄ±rganÄ±n iÅŸini kolaylaÅŸtÄ±ran, sisteme<br>veya kullanÄ±cÄ±lara dair bilgi sÄ±zdÄ±ran veya en iyi gÃ¼venlik<br>pratiklerine (best practices) uyulmamasÄ±ndan kaynaklanan<br>zafiyetler. Genellikle tek baÅŸÄ±na yÄ±kÄ±cÄ± deÄŸildir ancak baÅŸka bir<br>zafiyetle birleÅŸtirilerek (chained) kullanÄ±lÄ±r. |
| DÃœÅÃœK                | 0.1 -<br>3.9      | Kozmetik GÃ¼venlik<br>Etkisi dÃ¼ÅŸÃ¼k, istismarÄ± Ã§ok zor olan veya<br>uygulamanÄ±n<br>doÄŸrudan<br>gÃ¼venliÄŸini<br>(gizlilik,<br>bÃ¼tÃ¼nlÃ¼k,<br>eriÅŸilebilirlik) etkilemeyen yapÄ±landÄ±rma eksiklikleri ve en iyi<br>pratiklerin (best practices) ihlalleri.                                                                      |
| NONE                 | 0.0               | Aktif bir gÃ¼venlik riski oluÅŸturmaz; yalnÄ±zca bilgilendirme<br>amaÃ§lÄ±dÄ±r.                                                                                                                                                                                                                                               |

# <span id="page-6-1"></span><span id="page-6-0"></span>**ZAFÄ°YET BULGULARI VE DETAYLARI**

# **BULGU-01**

<span id="page-6-2"></span>

| Bulgu AdÄ±                                                   |             |                                              |
|-------------------------------------------------------------|-------------|----------------------------------------------|
| AÃ§Ä±k eriÅŸilebilir SQLite veritabanÄ± dosyasÄ±-database.sqlite |             |                                              |
| Bulgu Kodu                                                  |             |                                              |
| DBS_DISCLOSURE_01                                           |             |                                              |
| Ã–nem Derecesi                                               | CVSS        | Vektor String                                |
| High                                                        | 7.5<br>High | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N |
| EriÅŸim NoktasÄ±                                              |             | KullanÄ±cÄ± Profili                            |
| HTTP                                                        |             | ZiyaretÃ§i (anonim)                           |

## **Bulgunun Tespit EdildiÄŸi BileÅŸen/BileÅŸenler**

<http://localhost:8080/db/database.sqlite>

web root iÃ§inde doÄŸrudan eriÅŸilebilir SQLite dosyasÄ±

# **Zafiyetin Etkisi**

Confidentiality (C): High â€” VeritabanÄ± dosyasÄ±nÄ±n indirilmesiyle kullanÄ±cÄ± adlarÄ±, e-posta adresleri, parola hash'leri, sipariÅŸ ve iÅŸlem kayÄ±tlarÄ± gibi hassas bilgiler aÃ§Ä±ÄŸa Ã§Ä±kabilir.

#### **OlasÄ± kÃ¶tÃ¼ye kullanÄ±m senaryolarÄ±:**

- Parola hash'lerinin elde edilmesi halinde offline brute-force/wordlist saldÄ±rÄ±larÄ±yla hesaplar ele geÃ§irilebilir; zayÄ±f hash/salt varsa risk artar.
- Elde edilen kullanÄ±cÄ± adlarÄ± ile credential stuffing veya brute-force saldÄ±rÄ±larÄ± yapÄ±labilir. Bunun sonucu yetkisiz iÅŸlemler ve hesap ele geÃ§irme olabilir.

**Integrity / Availability:** Bu tespit, dosyanÄ±n okunmasÄ±na izin verir; doÄŸrudan veri deÄŸiÅŸikliÄŸi veya hizmet kesintisi yaratmaz. Ancak yukarÄ±daki ikincil senaryolar (ele geÃ§irilmiÅŸ hesaplar) dolaylÄ± integrity/availability etkilerine sebep olabilir.

# **Zaafiyetin AÃ§Ä±klamasÄ±**

Uygulama dizininde bulunan db/database.sqlite dosyasÄ±na web sunucusu Ã¼zerinden kimlik doÄŸrulama olmadan eriÅŸilebilmektedir. Herhangi bir anonim kullanÄ±cÄ± tarayÄ±cÄ± veya curl/wget ile dosyayÄ± indirip iÃ§eriÄŸini inceleyebilir; bu da tÃ¼m veritabanÄ± iÃ§eriÄŸinin aÃ§Ä±ÄŸa Ã§Ä±kmasÄ±na neden olur.

### **Tetiklenme / Reproduce AdÄ±mlarÄ±**

TarayÄ±cÄ±da http://localhost:8080/db/database.sqlite adresine git. Dosya doÄŸrudan indirilecektir. Veya terminalden curl -o database.sqlite http://<hedefhost>:8080/db/ database.sqlite komutunu Ã§alÄ±ÅŸtÄ±rÄ±rsan dosya indirilecektir.

# **Ã‡Ã¶zÃ¼m Ã–nerileri**

**DosyalarÄ± Web KÃ¶k Dizininden TaÅŸÄ±ma:** Veri tabanÄ± gibi hassas dosyalar asla web sunucusunun doÄŸrudan eriÅŸebileceÄŸi bir dizinde barÄ±ndÄ±rÄ±lmamalÄ±dÄ±r. Bu dosyalar, web kÃ¶k dizininin bir Ã¼st seviyesine proje kÃ¶kÃ¼ne taÅŸÄ±nmalÄ±dÄ±r. PHP betikleri bu dosyalara include '../config.php' gibi dosya sistemi yollarÄ±yla eriÅŸmeye devam edebilir, ancak dÄ±ÅŸarÄ±dan bir kullanÄ±cÄ± URL ile eriÅŸemez.

**Sunucu YapÄ±landÄ±rmasÄ± ile EriÅŸimi Engelleme:** EÄŸer dosya yapÄ±sÄ±nÄ± deÄŸiÅŸtirmek mimari nedenlerle mÃ¼mkÃ¼n deÄŸilse, web sunucusu (Ã¶rn: Apache) bu dosyalara ve dizinlere yapÄ±lan tÃ¼m web isteklerini engelleyecek ÅŸekilde yapÄ±landÄ±rÄ±lmalÄ±dÄ±r. Bu, projenin ana dizinine eklenecek bir .htaccess dosyasÄ± ile saÄŸlanabilir

## **Referanslar**

*<https://cwe.mitre.org/data/definitions/219.html>*

*<https://www.php.net/manual/en/security.php>*

# <span id="page-8-0"></span>**BULGU-02**

<span id="page-8-1"></span>

| Bulgu AdÄ±                                                     |           |                                              |  |
|---------------------------------------------------------------|-----------|----------------------------------------------|--|
| Kupon DoÄŸrulama EksikliÄŸinden Kaynaklanan Ä°ÅŸ MantÄ±ÄŸÄ± Zafiyeti |           |                                              |  |
| Bulgu Kodu                                                    |           |                                              |  |
| LOGIC_VOUCHER_01                                              |           |                                              |  |
| Ã–nem Derecesi                                                 | CVSS      | Vektor String                                |  |
| Medium                                                        | 4.3Medium | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N |  |
| EriÅŸim NoktasÄ±                                                |           | KullanÄ±cÄ± Profili                            |  |
| HTTP                                                          |           | User<br>(KullanÄ±cÄ±)                          |  |

### **Bulgunun Tespit EdildiÄŸi BileÅŸen/BileÅŸenler**

<http://localhost:5005/cart.php>

## **Zafiyetin Etkisi**

**Integrity (I): High** â€” Zafiyet, uygulamanÄ±n temel iÅŸ mantÄ±ÄŸÄ±nÄ± fiyatlandÄ±rmayÄ± manipÃ¼le eder. SaldÄ±rgan, normalde yetkisi olmayan indirimleri sepetine uygulayarak sipariÅŸin son fiyatÄ±nÄ± yasa dÄ±ÅŸÄ± bir ÅŸekilde deÄŸiÅŸtirebilir.

#### **OlasÄ± kÃ¶tÃ¼ye kullanÄ±m senaryolarÄ±:**

â€¢ Sadece belirli bir firmaya (A FirmasÄ±) tanÄ±mlanmÄ±ÅŸ yÃ¼ksek deÄŸerli bir indirim kuponu, bu zafiyet kullanÄ±larak sistemdeki diÄŸer tÃ¼m firmalardan (B, C, D FirmalarÄ±) bilet almak iÃ§in kullanÄ±labilir.

#### **Zaafiyetin AÃ§Ä±klamasÄ±**

UygulamanÄ±n sepet yÃ¶netim mantÄ±ÄŸÄ±, bir kupon uygulandÄ±ktan sonra sepet iÃ§eriÄŸi deÄŸiÅŸtiÄŸinde, uygulanan kuponun yeni sepet iÃ§eriÄŸiyle yeniden kontrol edilmesi gerÃ§ekleÅŸtirmemektedir.

Kuponun geÃ§erliliÄŸi, sepete eklendiÄŸi *an* bir kez kontrol edilmekte, ancak sepet gÃ¼ncellendiÄŸinde bu onaylanmÄ±ÅŸ indirim durumu sepetten kaldÄ±rÄ±lmamaktadÄ±r. Bu durum, bir firmaya (A FirmasÄ±) ait kuponun, o firma sepetten Ã§Ä±karÄ±ldÄ±ktan sonra bile B FirmasÄ±'nÄ±n biletine uygulanmasÄ±na olanak tanÄ±r. Bu, CWE-840: Business Logic Vulnerability (Ä°ÅŸ MantÄ±ÄŸÄ± Zafiyeti) olarak sÄ±nÄ±flandÄ±rÄ±lÄ±r.

## **Tetiklenme / Reproduce AdÄ±mlarÄ±**

Oturum aÃ§mÄ±ÅŸ bir kullanÄ±cÄ± olarak, A FirmasÄ±'na ait bir bileti sepete ekle.

Sepet sayfasÄ±nda (cart.php), sadece A FirmasÄ±'na Ã¶zel olan bir kupon kodunu gir ve uygula.

Ä°ndirimin sepete baÅŸarÄ±yla uygulandÄ±ÄŸÄ± gÃ¶zlemle.

Åimdi, A FirmasÄ±'na ait bileti sepetten kaldÄ±r.

B FirmasÄ±'na ait bir bileti sepete ekle.

Sepet Ã¶zetini kontrol et. Bir Ã¶nceki kupondan kaynaklanan indirimin hala aktif olduÄŸu ve B FirmasÄ±'nÄ±n bilet fiyatÄ±na uygulandÄ±ÄŸÄ± gÃ¶rÃ¼lÃ¼r.

![](images/_page_9_Picture_7.jpeg)

| Sepetim                                                                                                                                 |        |
|-----------------------------------------------------------------------------------------------------------------------------------------|--------|
|                                                                                                                                         |        |
| Varan Turizm                                                                                                                            |        |
| istanbul â†’ Ankara                                                                                                                       |        |
| 30.10.2025 23:07 â†’ 09:06                                                                                                                |        |
| Bilet FiyatÄ±: 150.00 â‚º                                                                                                                  |        |
| Mevcut Koltuk: 40                                                                                                                       |        |
| SeÃ§ilen Koltuklar: 38                                                                                                                   |        |
| Bilet SayÄ±sÄ±: 1 Toplam: 150.00 â‚¬                                                                                                        |        |
| ğŸ’¡ Koltuk seÃ§imli biletlerde miktar deÄŸiÅŸtirilemez. Koltuk deÄŸiÅŸtirmek iÃ§in Ã¼rÃ¼nÃ¼ kaldÄ±rÄ±p tekrar seÃ§in.                                 |        |
| KaldÄ±r                                                                                                                                  |        |
| Kaluli                                                                                                                                  |        |
|                                                                                                                                         |        |
|                                                                                                                                         |        |
| Sepeti GÃ¼ncelle                                                                                                                         |        |
| Sepeti GÃ¼ncelle                                                                                                                         |        |
| Sepeti GÃ¼ncelle                                                                                                                         |        |
|                                                                                                                                         |        |
| Sepeti GÃ¼ncelle<br>Ãndirim Kuponu                                                                                                       |        |
| Ä°ndirim Kuponu                                                                                                                          | Kalde  |
|                                                                                                                                         | Kalde  |
| Ãndirim Kuponu                                                                                                                          | Kalde  |
| Ãndirim Kuponu                                                                                                                          | Kalder |
| Ä°ndirim Kuponu  Kupon uygulandÄ±: METRO1 (%50 indirim)                                                                                   | Kadr   |
| Ä°ndirim Kuponu  Kupon uygulandÄ±: METRO1 (%50 indirim)  Sepet Ã–zeti                                                                      | Kalder |
| Ä°ndirim Kuponu  Kupon uygulandÄ±: METRO1 (%50 indirim)  Sepet Ã–zeti  Ara Toplam: 150.00 &                                                | Kalder |
| Ä°ndirim Kuponu  Kupon uygulandÄ±: METRO1 (%50 indirim)  Sepet Ã–zeti                                                                      | Kalder |
| indirim Kuponu  Kupon uygulandÄ±: METRO1 (%50 indirim)  Sepet Ã–zeti  Ara Toplam: 150.00 & indirim (%50): -75.00 &                        | Kalde  |
| Ä°ndirim Kuponu  Kupon uygulandÄ±: METRO1 (%50 indirim)  Sepet Ã–zeti  Ara Toplam: 150.00 &                                                | Kalde  |
| indirim Kuponu  Kupon uygulandÄ±: METRO1 (%50 indirim)  Sepet Ã–zeti  Ara Toplam: 150.00 & indirim (%50): -75.00 &  Toplam Tutar: 75.00 & | Kalde  |

# **Ã‡Ã¶zÃ¼m Ã–nerileri**

cart.php (veya sepeti yÃ¶neten herhangi bir sunucu tarafÄ± betik), sepete her Ã¼rÃ¼n eklendiÄŸinde VEYA Ã§Ä±karÄ±ldÄ±ÄŸÄ±nda Ã§alÄ±ÅŸacak bir fonksiyon iÃ§ermelidir.

Bu fonksiyon, sepette halihazÄ±rda uygulanmÄ±ÅŸ bir kupon (\$\_SESSION['coupon'] gibi) varsa, bu kuponun mevcut sepet iÃ§eriÄŸiyle (tutar, firma, sefer ID'si vb.) olan uygunluÄŸunu veritabanÄ±ndan yeniden doÄŸrulamalÄ±dÄ±r.

EÄŸer kupon artÄ±k sepetle uyumlu deÄŸilse, kupon otomatik olarak sepetten (session'dan) kaldÄ±rÄ±lmalÄ± ve kullanÄ±cÄ±ya Sepet iÃ§eriÄŸiniz deÄŸiÅŸtiÄŸi iÃ§in X kuponu kaldÄ±rÄ±ldÄ±. gibi bir mesaj gÃ¶sterilmelidir.

#### **Referanslar**

*https://cwe.mitre.org/data/definitions/840.html*

# <span id="page-11-0"></span>**BULGU-03**

<span id="page-11-1"></span>

| Bulgu AdÄ±                              |             |                                                                         |
|----------------------------------------|-------------|-------------------------------------------------------------------------|
| Siteler ArasÄ± Ä°stek SahteciliÄŸi (CSRF) |             |                                                                         |
| Bulgu Kodu                             |             |                                                                         |
| CSRF_ALL_FORMS_01                      |             |                                                                         |
| Ã–nem Derecesi                          | CVSS        | Vektor String                                                           |
| High                                   | 8.1<br>High | CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H                            |
| EriÅŸim NoktasÄ±                         |             | KullanÄ±cÄ± Profili                                                       |
| HTTP                                   |             | Oturumu<br>aÃ§Ä±k userâ€” Oturumu<br>aÃ§Ä±k company/<br>Oturumu<br>aÃ§Ä±k admin |

| Bulgunun Tespit EdildiÄŸi BileÅŸen/BileÅŸenler           |  |  |
|-------------------------------------------------------|--|--|
| http://localhost:5005/cart.php                        |  |  |
| http://localhost:8080/cancel_ticket.php               |  |  |
| http://localhost:8080/trip.php                        |  |  |
| http://localhost:8080/edit_trip.php                   |  |  |
| http://localhost:8080/new_trip.php                    |  |  |
| http://localhost:8080/delete_trip.php                 |  |  |
| http://localhost:8080/admin/manage_companies.php      |  |  |
| http://localhost:8080/admin/manage_coupons.php        |  |  |
| http://localhost:8080/admin/add_company.php           |  |  |
| http://localhost:8080/admin/manage_company_admins.php |  |  |
| http://localhost:8080/admin/manage_users.php          |  |  |
| http://localhost:8080/admin/edit_company.php          |  |  |

## **Zafiyetin Etkisi**

**Integrity (I): High â€”** SaldÄ±rgan, kurbanÄ±n yetkileri dahilinde uygulamadaki hemen hemen her veriyi (sefer bilgileri, firma detaylarÄ±, kuponlar, kullanÄ±cÄ± hesaplarÄ±) kurbanÄ±n haberi olmadan deÄŸiÅŸtirebilir veya silebilir. FiyatlarÄ± manipÃ¼le edebilir, sahte iÃ§erik (firma, admin, kupon) ekleyebilir.

**Availability (A): High â€”** SaldÄ±rgan, kritik verilerin (tÃ¼m firmalar, tÃ¼m seferler) silinmesini tetikleyerek uygulamanÄ±n veya belirli bÃ¶lÃ¼mlerinin kullanÄ±lamaz hale gelmesine neden olabilir. Ã–rneÄŸin, tÃ¼m firmalarÄ±n silinmesi, platformun iÅŸlevsiz kalmasÄ±na yol aÃ§ar.

#### **OlasÄ± kÃ¶tÃ¼ye kullanÄ±m senaryolarÄ±:**

- Oturumu aÃ§Ä±k bir admin kandÄ±rÄ±larak sistemdeki tÃ¼m firmalarÄ±n silinmesi.
- Oturumu aÃ§Ä±k bir admin kandÄ±rÄ±larak meÅŸru bir firmaya saldÄ±rganÄ±n kontrolÃ¼nde yeni bir company admini eklenmesi (Yetki YÃ¼kseltme).
- Oturumu aÃ§Ä±k bir company admini kandÄ±rÄ±larak tÃ¼m seferlerinin silinmesi veya fiyatlarÄ±nÄ±n "1 TL" olarak gÃ¼ncellenmesi.
- Oturumu aÃ§Ä±k bir company admini kandÄ±rÄ±larak firmaya ait tÃ¼m indirim kuponlarÄ±nÄ±n silinmesi veya "%100 indirimli" sahte kuponlar eklenmesi.
- Oturumu aÃ§Ä±k bir user kandÄ±rÄ±larak sepetindeki Ã¼rÃ¼nlerin haberi olmadan satÄ±n alÄ±nmasÄ± veya tÃ¼m biletlerinin iptal edilerek para iadesi aldÄ±rÄ±lmasÄ±.

## **Zaafiyetin AÃ§Ä±klamasÄ±**

Uygulama genelinde, kullanÄ±cÄ±nÄ±n oturumunda durum deÄŸiÅŸikliÄŸine neden olan (veri ekleme, silme, gÃ¼ncelleme vb.) POST isteklerini iÅŸleyen formlar, bu isteklerin gerÃ§ekten kullanÄ±cÄ±nÄ±n o anki oturumu sÄ±rasÄ±nda bilinÃ§li olarak mÄ± yapÄ±ldÄ±ÄŸÄ±nÄ± yoksa harici bir kaynaktan mÄ± tetiklendiÄŸini doÄŸrulamak iÃ§in kullanÄ±lan Anti-CSRF token mekanizmasÄ±nÄ± iÃ§ermemektedir. Sunucu tarafÄ± kodlarÄ±, bir isteÄŸin meÅŸruluÄŸunu sadece istekle birlikte gelen oturum Ã§erezinin (Ã¶rn: PHPSESSID) geÃ§erliliÄŸine bakarak kontrol etmektedir. Bu durum, bir saldÄ±rganÄ±n, oturumu aÃ§Ä±k bir kurbanÄ± kendi hazÄ±rladÄ±ÄŸÄ± zararlÄ± bir web sayfasÄ±na yÃ¶nlendirerek, kurbanÄ±n tarayÄ±cÄ±sÄ±nÄ±n arka planda bu savunmasÄ±z formlara (kurbanÄ±n oturum Ã§ereziyle birlikte) otomatik olarak istek gÃ¶ndermesini saÄŸlamasÄ±na olanak tanÄ±r. Sunucu, istekle birlikte geÃ§erli oturum Ã§erezini gÃ¶rdÃ¼ÄŸÃ¼ iÃ§in, isteÄŸin kaynaÄŸÄ±nÄ± sorgulamadan iÅŸlemi kurban adÄ±na gerÃ§ekleÅŸtirir.

# **Tetiklenme / Reproduce AdÄ±mlarÄ±**

User hesabÄ±yla http://localhost:8080 adresinde oturum aÃ§Ä±lÄ±r.

Sepete bir bilet eklenir ancak satÄ±n alma iÅŸlemi tamamlanmaz.

SaldÄ±rgan kÃ¶tÃ¼ niyetli bir iÃ§erik Ã¼retir.

SaldÄ±rgan, kurbanÄ± herhangi bir yÃ¶ntemle (e-posta, sosyal medya mesajÄ±, baÅŸka bir web sitesindeki link/resim/reklam) kÃ¶tÃ¼ niyetli bir iÃ§eriÄŸe tÄ±klamaya veya o iÃ§eriÄŸin yÃ¼klenmesini saÄŸlamaya ikna eder. AÅŸaÄŸÄ±daki Ã¶rnekteki gibi.

![](images/_page_13_Figure_5.jpeg)

kaynak kodu temel olarak ÅŸu kÄ±sÄ±m Ã¶nemli: <form name="csrfForm" action="http://localhost :8080/cart.php" method="POST" target= "hiddenFrame" > <input type="hidden" name="checkout" value="" /> </form>

EÄŸer kullanÄ±cÄ± butona tÄ±klarsa gizli form otomatik olarak kurbanÄ±n tarayÄ±cÄ±sÄ±ndan http://localhost:8080/cart.php adresine checkout= parametresiyle gÃ¶nderilir.

Kurban, cart.php sayfasÄ±na geri dÃ¶nÃ¼p yenilediÄŸinde "SatÄ±n alma baÅŸarÄ±lÄ±!" mesajÄ±nÄ± ve sepetinin boÅŸaldÄ±ÄŸÄ±nÄ± gÃ¶rÃ¼r. account.php sayfasÄ±nda ise bakiyesinin dÃ¼ÅŸtÃ¼ÄŸÃ¼ ve biletin hesabÄ±na eklendiÄŸi doÄŸrulanÄ±r. Kurban, sadece "Tebrikler" diyen bir sayfaya tÄ±klayarak haberi olmadan para harcamÄ±ÅŸ olur.

![](images/_page_13_Picture_9.jpeg)

![](images/_page_14_Picture_0.jpeg)

## **Ã‡Ã¶zÃ¼m Ã–nerileri**

TÃ¼m state-changing (durum deÄŸiÅŸtiren - Ekleme, Silme, GÃ¼ncelleme, SatÄ±n Alma) formlara Anti-CSRF Token (Synchronizer Token Pattern) korumasÄ± eklenmelidir.

#### **Token OluÅŸturma**

KullanÄ±cÄ± oturum aÃ§tÄ±ÄŸÄ±nda, config.php veya merkezi bir betikte, kriptografik olarak gÃ¼venli, benzersiz ve tahmin edilemez bir token Ã¼retilmelidir. Bu token, \$\_SESSION['csrf\_token'] iÃ§inde saklanmalÄ±dÄ±r.

#### **Ã–rnek**

if (empty(\$\_SESSION['csrf\_token'])) { \$\_SESSION['csrf\_token'] = bin2hex(random\_bytes(32)); }

#### **Token'Ä± Forma Ekleme:**

DeÄŸiÅŸiklik yapan tÃ¼m HTML formlarÄ±na bu token gizli bir input alanÄ± olarak eklenmelidir.

#### **Ã–rnek**

<form action="delete\_trip.php" method="POST"> <input type="hidden" name="csrf\_token" value="<?php echo htmlspecialchars(\$\_SESSION['csrf\_token']); ?>"> <button type="submit">Seferi Sil</button> </form>

#### **Token'Ä± DoÄŸrulama**

Sunucu tarafÄ±nda POST isteÄŸi iÅŸlenmeden *hemen Ã¶nce*, formdan gelen token ile session'da saklanan token'Ä±n eÅŸleÅŸip eÅŸleÅŸmediÄŸi kontrol edilmelidir.

#### **Referanslar**

*<https://cwe.mitre.org/data/definitions/352.html>*

*[https://cheatsheetseries.owasp.org/cheatsheets/Cross-](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)*

*[Site\\_Request\\_Forgery\\_Prevention\\_Cheat\\_Sheet.html](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)*

<span id="page-15-1"></span><span id="page-15-0"></span>

| Bulgu AdÄ±              |                 |                                              |  |
|------------------------|-----------------|----------------------------------------------|--|
| ZayÄ±f Kimlik DoÄŸrulama |                 |                                              |  |
| Bulgu Kodu             |                 |                                              |  |
| AUTHN_BRUTEFORCE_01    |                 |                                              |  |
| Ã–nem Derecesi          | CVSS            | Vektor String                                |  |
| Critical               | 9.8<br>Critical | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |  |
| EriÅŸim NoktasÄ±         |                 | KullanÄ±cÄ± Profili                            |  |
| HTTP                   |                 | ZiyaretÃ§i(Anonim)                            |  |

#### **Bulgunun Tespit EdildiÄŸi BileÅŸen/BileÅŸenler**

<http://localhost:8080/login.php>

#### **Zafiyetin Etkisi**

Bu zafiyet, uygulamanÄ±n kimlik doÄŸrulama mekanizmasÄ±ndaki temel bir eksiklikten kaynaklanÄ±r ve sistemin tamamen ele geÃ§irilmesine yol aÃ§abilir.

Confidentiality (H), Integrity (H), Availability (H): Zafiyet, saldÄ±rganÄ±n admin@example.com gibi bilinen bir yÃ¶netici veya firma hesabÄ±nÄ± hedef alarak parola kÄ±rma denemesi yapmasÄ±na olanak tanÄ±r. BaÅŸarÄ±lÄ± bir saldÄ±rÄ± sonucunda:

- Sistem Ele GeÃ§irilir: SaldÄ±rgan, yÃ¶netici yetkileriyle oturum aÃ§ar.
- TÃ¼m Veriler SÄ±zdÄ±rÄ±lÄ±r: TÃ¼m kullanÄ±cÄ±larÄ±n kiÅŸisel bilgileri, bilet geÃ§miÅŸleri ve firma bilgileri Ã§alÄ±nabilir.
- TÃ¼m Veriler ManipÃ¼le Edilebilir: Sefer fiyatlarÄ± deÄŸiÅŸtirilebilir, biletler silinebilir, sahte yÃ¶netici hesaplarÄ± oluÅŸturulabilir.
- Sistem Durdurulabilir: TÃ¼m verilerin (kullanÄ±cÄ±lar, seferler) silinmesi yoluyla uygulama tÃ¼m kullanÄ±cÄ±lar iÃ§in eriÅŸilemez hale getirilebilir.

## **Zaafiyetin AÃ§Ä±klamasÄ±**

Login.php betiÄŸi, bir kullanÄ±cÄ±nÄ±n (veya bir IP adresinin) belirli bir zaman diliminde kaÃ§ kez hatalÄ± parola denemesi yaptÄ±ÄŸÄ±nÄ± kÄ±sÄ±tlayan bir mekanizmaya veya hesap kilitleme politikasÄ±na sahip deÄŸildir.

Bir saldÄ±rgan, admin@example.com gibi bilinen bir hesaba karÅŸÄ±, yaygÄ±n ÅŸifre listeleri kullanarak saniyede binlerce otomatik parola denemesi (Brute Force SaldÄ±rÄ±sÄ±) gerÃ§ekleÅŸtirebilir. PHP'nin password\_verify fonksiyonu gÃ¼venli bir karma (hash) karÅŸÄ±laÅŸtÄ±rmasÄ± yapsa da, sunucu tarafÄ±nda bir deneme kÄ±sÄ±tlamasÄ± olmadÄ±ÄŸÄ±ndan bu tÃ¼r otomatik saldÄ±rÄ±lara karÅŸÄ± tek baÅŸÄ±na bir koruma saÄŸlamaz.

## **Tetiklenme / Reproduce AdÄ±mlarÄ±**

Bir saldÄ±rgan, hedef olarak admin@example.com gibi geÃ§erli bir kullanÄ±cÄ± adÄ± belirler. Kalideki ffuf komutu ile hazÄ±r bir seclist olan rockyou.txt kullanÄ±larak brÃ¼te force yapÄ±lÄ±r.

#### **Komut**

ffuf -u http://192.168.84.1:8080/login.php -w /usr/share/wordlists/rockyou.txt -X POST -d "email=admin%40admin.com&password=FUZZ" -H "Content-Type: application/x-wwwform-urlencoded" -fs 721

Sunucudan hiÃ§bir kÄ±sÄ±tlama gelmediÄŸi iÃ§in saldÄ±rÄ±, doÄŸru parola bulunana kadar kesintisiz devam eder.

EÄŸer doÄŸru parola bulunursa ffuf toolu ekrana ÅŸifreyi basar.

# **Ã‡Ã¶zÃ¼m Ã–nerileri**

Uygulamaya kademeli bir savunma mekanizmasÄ± eklenmelidir.

#### **Hesap Kilitleme (Account Lockout)**

VeritabanÄ±ndaki users tablosuna failed\_login\_attempts (INT) ve last\_failed\_login (TIMESTAMP) gibi iki yeni sÃ¼tun eklenmelidir.

- KullanÄ±cÄ± ÅŸifreyi yanlÄ±ÅŸ girdiÄŸinde failed\_login\_attempts sayacÄ± 1 artÄ±rÄ±lÄ±r.
- Sayac 5'e (veya 10'a) ulaÅŸtÄ±ÄŸÄ±nda, hesap kilitlenmeli ve kullanÄ±cÄ±ya parola sÄ±fÄ±rlama epostasÄ± gÃ¶nderilmelidir. Bu, hedefli saldÄ±rÄ±larÄ± tamamen durdurur.

#### **HÄ±z KÄ±sÄ±tlama (Rate Limiting)**

Belirli bir IP adresinden, kÄ±sa bir sÃ¼re iÃ§inde (Ã¶rn. 1 dakika) login.php'ye gelen POST isteklerinin sayÄ±sÄ± sÄ±nÄ±rlandÄ±rÄ±lmalÄ±dÄ±r.

â€¢ Ã–rn: Bir IP, 1 dakika iÃ§inde 20'den fazla hatalÄ± giriÅŸ denemesi yaparsa, o IP 15 dakika boyunca engellenmeli ve HTTP 429 Too Many Requests yanÄ±tÄ± dÃ¶ndÃ¼rÃ¼lmelidir. Bu, yaygÄ±n (noisy) brute-force saldÄ±rÄ±larÄ±nÄ± yavaÅŸlatÄ±r.

**CAPTCHA:** 3 hatalÄ± giriÅŸ denemesinden sonra, kullanÄ±cÄ±ya bir CAPTCHA gÃ¶sterilmelidir. Bu, otomatik bot saldÄ±rÄ±larÄ±nÄ± bÃ¼yÃ¼k Ã¶lÃ§Ã¼de engeller.

## **Referanslar**

*<https://cwe.mitre.org/data/definitions/307.html>*

*[https://owasp.org/Top10/A07\\_2021-](https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/)*

*[Identification\\_and\\_Authentication\\_Failures/](https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/)*